<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(GS11) VI·∫æT L·∫†I C√ÇU U678 - √îN T·∫¨P GI·ªÆA K√å 2</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8854C0;
            --secondary: #00C9A7;
            --correct: #00D26A;
            --wrong: #FF4757;
            --background: #f0f3f5;
            --card-bg: #ffffff;
            --text-main: #2f3542;
            --text-light: #57606f;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background-color: var(--background);
            background-image: radial-gradient(#dcdde1 15%, transparent 16%), radial-gradient(#dcdde1 15%, transparent 16%);
            background-size: 60px 60px;
            background-position: 0 0, 30px 30px;
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .header-container {
            text-align: center;
            margin-bottom: 30px;
            animation: popIn 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }

        h1 {
            color: var(--primary);
            font-weight: 800;
            font-size: 2.2rem;
            margin: 0;
            text-shadow: 2px 2px 0px #fff, 4px 4px 0px rgba(0,0,0,0.1);
        }

        h3 {
            color: var(--text-light);
            font-weight: 600;
            margin-top: 5px;
            font-size: 1.1rem;
        }

        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        .question-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 0 rgba(0,0,0,0.1);
            border: 2px solid #eee;
            position: relative;
            transition: transform 0.3s;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 2px dashed #f1f2f6;
            padding-bottom: 10px;
        }

        .q-tag {
            background: var(--secondary);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 3px 0 rgba(0,0,0,0.1);
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--text-main);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .answer-input {
            width: 100%;
            padding: 15px 20px;
            font-size: 1.1rem;
            border: 2px solid #e1e4e8;
            border-radius: 15px;
            margin-bottom: 15px;
            font-family: 'Nunito', sans-serif;
            box-shadow: 0 5px 0 #d1d8e0;
            transition: all 0.1s;
        }
        .answer-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 5px 0 #00a187;
        }
        .answer-input.error {
            border-color: var(--wrong);
            box-shadow: 0 5px 0 #b22234;
            background-color: #fff0f0;
            animation: shake 0.3s;
        }
        .answer-input.correct {
            border-color: var(--correct);
            box-shadow: 0 5px 0 #008f47;
            background-color: #f0fff0;
        }
        .answer-input.wrong {
            border-color: var(--wrong);
            box-shadow: 0 5px 0 #b22234;
            background-color: #fff0f0;
        }

        .hint-container {
            margin: 10px 0 15px;
        }
        .hint-btn {
            background: #f0f4fa;
            border: 2px solid var(--primary);
            color: var(--primary);
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
            box-shadow: 0 3px 0 #b1a0d0;
        }
        .hint-btn:hover {
            background: var(--primary);
            color: white;
        }
        .hint-content {
            display: none;
            background: #f8f0fc;
            border-left: 5px solid var(--primary);
            padding: 15px 20px;
            border-radius: 12px;
            margin-top: 10px;
            font-size: 1rem;
            color: #2c3e50;
            animation: slideDown 0.3s ease;
            white-space: pre-wrap;
        }

        .check-wrapper {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 10px 0;
        }
        .check-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 700;
            border-radius: 30px;
            box-shadow: 0 5px 0 #5f2a9e;
            cursor: pointer;
            transition: transform 0.1s;
            display: inline-block;
        }
        .check-btn:active {
            box-shadow: 0 2px 0 #5f2a9e;
            transform: translateY(3px);
        }
        .check-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            box-shadow: 0 5px 0 #5f2a9e;
        }
        .feedback-message {
            font-size: 1rem;
            font-weight: 600;
            padding: 8px 15px;
            border-radius: 30px;
            background: #f0f0f0;
        }
        .feedback-message.correct-feedback {
            color: #008f47;
            background: #e0ffe0;
        }
        .feedback-message.wrong-feedback {
            color: #b22234;
            background: #ffe0e0;
        }

        .explanation-box {
            display: none;
            margin-top: 20px;
            background-color: #f8f0fc;
            border: 2px solid var(--primary);
            border-radius: 15px;
            padding: 20px;
            animation: slideDown 0.5s ease;
        }
        .explanation-header {
            color: var(--primary);
            font-weight: 800;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .explanation-content {
            font-size: 1rem;
            line-height: 1.6;
            color: #4b4b4b;
            white-space: pre-wrap;
        }

        .footer-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 15px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            z-index: 100;
        }
        .submit-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 40px;
            font-size: 1.2rem;
            font-weight: 800;
            border-radius: 30px;
            box-shadow: 0 6px 0 #5f2a9e;
            cursor: pointer;
            transition: transform 0.1s;
        }
        .submit-btn:active {
            box-shadow: 0 3px 0 #5f2a9e;
            transform: translateY(3px);
        }
        .score-display {
            font-weight: 800;
            font-size: 1.2rem;
            color: var(--text-main);
        }

        @keyframes popIn {
            0% { transform: scale(0); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes shake {
            0%,100% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(-5deg); }
            75% { transform: translateX(5px) rotate(5deg); }
        }

        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }

        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: popIn 0.5s;
            border: 5px solid var(--secondary);
        }
        .final-score {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            margin: 20px 0;
        }
        .feedback-text {
            font-size: 1.2rem;
            color: var(--text-light);
            margin-bottom: 30px;
        }

        u {
            text-decoration: underline;
            text-underline-offset: 4px;
            text-decoration-thickness: 2px;
            text-decoration-color: var(--primary);
        }
    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="header-container">
    <h1>(GS11) VI·∫æT L·∫†I C√ÇU U678 - √îN T·∫¨P GI·ªÆA K√å 2</h1>
    <h3> </h3>
</div>

<div class="quiz-container" id="quiz-area"></div>

<div class="footer-controls">
    <div class="score-display">ƒê√£ ki·ªÉm tra: <span id="progress-text">0</span>/<span id="total-text">0</span></div>
    <button class="submit-btn" onclick="finishQuiz()">XEM T·ªîNG K·∫æT</button>
</div>

<div class="modal-overlay" id="result-modal">
    <div class="modal-content">
        <h2 style="color: var(--secondary); font-weight: 800;">T·ªîNG K·∫æT</h2>
        <div class="final-score" id="final-score-display">0/0</div>
        <p class="feedback-text" id="feedback-msg">B·∫°n ƒë√£ l√†m r·∫•t t·ªët!</p>
        <button class="submit-btn" onclick="location.reload()">L√ÄM L·∫†I</button>
    </div>
</div>

<script>
    const quizData = [
        // UNIT 6: TO-INFINITIVE CLAUSES
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "Trang An Scenic Landscape Complex was recognized as a mixed World Heritage Site. It is the only mixed heritage site in Southeast Asia.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "Trang An Scenic Landscape Complex is the only mixed heritage site in Southeast Asia to be recognized as a mixed World Heritage Site.",
            "explanation": "M·ªánh ƒë·ªÅ \"to be recognized\" di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa vi·ªác Trang An ƒë∆∞·ª£c c√¥ng nh·∫≠n l√† di s·∫£n th·∫ø gi·ªõi h·ªón h·ª£p.\nD·ªãch nghƒ©a: \"Qu·∫ßn th·ªÉ danh th·∫Øng Tr√†ng An l√† di s·∫£n vƒÉn h√≥a h·ªón h·ª£p duy nh·∫•t ·ªü ƒê√¥ng Nam √Å ƒë∆∞·ª£c c√¥ng nh·∫≠n.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "Minh left the show very early. He was the first person who did so.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "Minh was the first person to leave the show very early.",
            "explanation": "M·ªánh ƒë·ªÅ \"to leave\" di·ªÖn t·∫£ h√†nh ƒë·ªông c·ªßa Minh l√† ng∆∞·ªùi ƒë·∫ßu ti√™n r·ªùi kh·ªèi ch∆∞∆°ng tr√¨nh.\nD·ªãch nghƒ©a: \"Minh l√† ng∆∞·ªùi ƒë·∫ßu ti√™n r·ªùi kh·ªèi ch∆∞∆°ng tr√¨nh r·∫•t s·ªõm.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "We went to Hoi An last month. We wanted to visit the ancient buildings there.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "We went to Hoi An last month to visit the ancient buildings there.",
            "explanation": "M·ªánh ƒë·ªÅ \"to visit\" di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa chuy·∫øn ƒëi ƒë·∫øn H·ªôi An.\nD·ªãch nghƒ©a: \"Ch√∫ng t√¥i ƒë√£ ƒë·∫øn H·ªôi An th√°ng tr∆∞·ªõc ƒë·ªÉ thƒÉm c√°c c√¥ng tr√¨nh c·ªï ·ªü ƒë√≥.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "Anna joined the school trip. She was the last person who did so.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "Anna was the last person to join the school trip.",
            "explanation": "M·ªánh ƒë·ªÅ \"to join\" di·ªÖn t·∫£ h√†nh ƒë·ªông c·ªßa Anna l√† ng∆∞·ªùi cu·ªëi c√πng tham gia chuy·∫øn ƒëi.\nD·ªãch nghƒ©a: \"Anna l√† ng∆∞·ªùi cu·ªëi c√πng tham gia chuy·∫øn ƒëi c·ªßa tr∆∞·ªùng.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "We went to the Mekong River Delta. We wanted to watch live performances of don ca tai tu there.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "We went to the Mekong River Delta to watch live performances of don ca tai tu there.",
            "explanation": "M·ªánh ƒë·ªÅ \"to watch\" di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa chuy·∫øn ƒëi ƒë·∫øn ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long.\nD·ªãch nghƒ©a: \"Ch√∫ng t√¥i ƒë√£ ƒë·∫øn ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long ƒë·ªÉ xem c√°c bu·ªïi bi·ªÉu di·ªÖn ƒë·ªùn ca t√†i t·ª≠ tr·ª±c ti·∫øp ·ªü ƒë√≥.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "My parents went to Ha Long Bay. They wanted to take a three-day cruise there.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "My parents went to Ha Long Bay to take a three-day cruise there.",
            "explanation": "M·ªánh ƒë·ªÅ \"to take\" di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa chuy·∫øn ƒëi ƒë·∫øn H·∫° Long.\nD·ªãch nghƒ©a: \"B·ªë m·∫π t√¥i ƒë√£ ƒë·∫øn V·ªãnh H·∫° Long ƒë·ªÉ tham gia m·ªôt chuy·∫øn du thuy·ªÅn ba ng√†y ·ªü ƒë√≥.\""
        },
        {
            "unit": "UNIT 6: PRESERVING OUR HERITAGE - M·ªÜNH ƒê·ªÄ TO V",
            "question": "The local authority opened a visitor centre near the heritage site. They wanted to give tourists more information about the site.",
            "hint": "C√¢u n√†y c·∫ßn m·ªôt m·ªánh ƒë·ªÅ to-infinitive ƒë·ªÉ k·∫øt h·ª£p hai c√¢u.",
            "answer": "The local authority opened a visitor centre near the heritage site to give tourists more information about the site.",
            "explanation": "M·ªánh ƒë·ªÅ \"to give\" di·ªÖn t·∫£ m·ª•c ƒë√≠ch c·ªßa vi·ªác m·ªü trung t√¢m du kh√°ch.\nD·ªãch nghƒ©a: \"Ch√≠nh quy·ªÅn ƒë·ªãa ph∆∞∆°ng ƒë√£ m·ªü m·ªôt trung t√¢m du kh√°ch g·∫ßn di s·∫£n ƒë·ªÉ cung c·∫•p th√™m th√¥ng tin cho du kh√°ch v·ªÅ ƒë·ªãa ƒëi·ªÉm n√†y.\""
        },
        
        // UNIT 7: PERFECT PARTICIPLE CLAUSES / PERFECT GERUNDS
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "My mother didn‚Äôt go to university. She regretted it.",
            "hint": "regret (v) h·ªëi ti·∫øc - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect gerund.",
            "answer": "My mother regretted not having gone to university.",
            "explanation": "\"Not having gone\" l√† d·∫°ng perfect gerund, th·ªÉ hi·ªán r·∫±ng m·∫π c·ªßa t√¥i h·ªëi ti·∫øc v√¨ kh√¥ng ƒëi h·ªçc ƒë·∫°i h·ªçc.\nD·ªãch nghƒ©a: \"M·∫π t√¥i h·ªëi ti·∫øc v√¨ kh√¥ng ƒëi h·ªçc ƒë·∫°i h·ªçc.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "My sister finished school. Then she went to a vocational school to train to be a tour guide.",
            "hint": "finish (v) ho√†n th√†nh - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect participle.",
            "answer": "Having finished school, my sister went to a vocational school to train to be a tour guide.",
            "explanation": "\"Having finished\" l√† d·∫°ng perfect participle, th·ªÉ hi·ªán r·∫±ng vi·ªác ho√†n th√†nh tr∆∞·ªùng h·ªçc x·∫£y ra tr∆∞·ªõc khi ƒëi h·ªçc ngh·ªÅ.\nD·ªãch nghƒ©a: \"Sau khi ho√†n th√†nh tr∆∞·ªùng h·ªçc, ch·ªã t√¥i ƒë√£ ƒëi h·ªçc ngh·ªÅ ƒë·ªÉ ƒë√†o t·∫°o tr·ªü th√†nh m·ªôt h∆∞·ªõng d·∫´n vi√™n du l·ªãch.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "My grandfather did not remember that he had lost his reading glasses.",
            "hint": "remember (v) nh·ªõ - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect gerund.",
            "answer": "My grandfather did not remember having lost his reading glasses.",
            "explanation": "\"Having lost\" l√† d·∫°ng perfect gerund, th·ªÉ hi·ªán r·∫±ng √¥ng kh√¥ng nh·ªõ vi·ªác ƒë√£ m·∫•t k√≠nh ƒë·ªçc s√°ch.\nD·ªãch nghƒ©a: \"√îng t√¥i kh√¥ng nh·ªõ ƒë√£ m·∫•t k√≠nh ƒë·ªçc s√°ch c·ªßa m√¨nh.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "My brother wrote his first travel book after he had returned from Japan.",
            "hint": "write (v) vi·∫øt - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect participle.",
            "answer": "Having returned from Japan, my brother wrote his first travel book.",
            "explanation": "\"Having returned\" l√† d·∫°ng perfect participle, th·ªÉ hi·ªán r·∫±ng vi·ªác tr·ªü v·ªÅ t·ª´ Nh·∫≠t B·∫£n x·∫£y ra tr∆∞·ªõc khi vi·∫øt s√°ch.\nD·ªãch nghƒ©a: \"Sau khi tr·ªü v·ªÅ t·ª´ Nh·∫≠t B·∫£n, anh trai t√¥i ƒë√£ vi·∫øt cu·ªën s√°ch du l·ªãch ƒë·∫ßu ti√™n c·ªßa m√¨nh.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "Trang won the first prize in the competition. She is very proud of this.",
            "hint": "win (v) gi√†nh chi·∫øn th·∫Øng - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect gerund.",
            "answer": "Trang is very proud of having won the first prize in the competition.",
            "explanation": "\"Having won\" l√† d·∫°ng perfect gerund, th·ªÉ hi·ªán r·∫±ng Trang t·ª± h√†o v·ªÅ vi·ªác gi√†nh gi·∫£i th∆∞·ªüng.\nD·ªãch nghƒ©a: \"Trang r·∫•t t·ª± h√†o v·ªÅ vi·ªác gi√†nh gi·∫£i nh·∫•t trong cu·ªôc thi.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "Nam worked as a mechanic‚Äôs apprentice and learnt useful job skills.",
            "hint": "work (v) l√†m vi·ªác - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect participle.",
            "answer": "Having worked as a mechanic‚Äôs apprentice, Nam learnt useful job skills.",
            "explanation": "\"Having worked\" l√† d·∫°ng perfect participle, th·ªÉ hi·ªán r·∫±ng Nam ƒë√£ l√†m vi·ªác tr∆∞·ªõc khi h·ªçc c√°c k·ªπ nƒÉng ngh·ªÅ nghi·ªáp.\nD·ªãch nghƒ©a: \"Sau khi l√†m vi·ªác nh∆∞ m·ªôt th·ª±c t·∫≠p sinh c∆° kh√≠, Nam ƒë√£ h·ªçc ƒë∆∞·ª£c nh·ªØng k·ªπ nƒÉng ngh·ªÅ nghi·ªáp h·ªØu √≠ch.\""
        },
        {
            "unit": "UNIT 7: EDUCATION OPTIONS FOR SCHOOL-LEAVERS - HO√ÄN TH√ÄNH PH√ÇN T·ª™ / DANH ƒê·ªòNG T·ª™ HO√ÄN TH√ÄNH",
            "question": "Phong achieved excellent grades at school, so he improved his chances of getting into a top university.",
            "hint": "achieve (v) ƒë·∫°t ƒë∆∞·ª£c - ch·ªó tr·ªëng c·∫ßn d·∫°ng perfect participle.",
            "answer": "Having achieved excellent grades at school, Phong improved his chances of getting into a top university.",
            "explanation": "\"Having achieved\" l√† d·∫°ng perfect participle, th·ªÉ hi·ªán r·∫±ng vi·ªác ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÉm s·ªë xu·∫•t s·∫Øc x·∫£y ra tr∆∞·ªõc khi c·∫£i thi·ªán c∆° h·ªôi v√†o ƒë·∫°i h·ªçc.\nD·ªãch nghƒ©a: \"Sau khi ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÉm s·ªë xu·∫•t s·∫Øc ·ªü tr∆∞·ªùng, Phong ƒë√£ c·∫£i thi·ªán c∆° h·ªôi v√†o m·ªôt tr∆∞·ªùng ƒë·∫°i h·ªçc h√†ng ƒë·∫ßu.\""
        },
        
        // UNIT 8: CLEFT SENTENCES (with underlined parts)
        {
            "unit": "UNIT 8: BECOMING INDEPENDENT - C√ÇU CH·∫∫",
            "question": "<u>Many teenagers</u> spend a lot of time thinking and talking about being in a relationship.",
            "hint": "many teenagers (n) nhi·ªÅu thanh thi·∫øu ni√™n - ch·ªó tr·ªëng c·∫ßn m·ªánh ƒë·ªÅ ch·∫ª.",
            "answer": "It is many teenagers who spend a lot of time thinking and talking about being in a relationship.",
            "explanation": "C·∫•u tr√∫c \"It is ... who\" ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫•n m·∫°nh ch·ªß ng·ªØ \"many teenagers\".\nD·ªãch nghƒ©a: \"Ch√≠nh nhi·ªÅu thanh thi·∫øu ni√™n l√† nh·ªØng ng∆∞·ªùi d√†nh nhi·ªÅu th·ªùi gian suy nghƒ© v√† n√≥i v·ªÅ vi·ªác c√≥ m·ªëi quan h·ªá.\""
        },
        {
            "unit": "UNIT 8: BECOMING INDEPENDENT - C√ÇU CH·∫∫",
            "question": "<u>My mother</u> wants you to contact him from time to time while you‚Äôre out.",
            "hint": "my mother (n) m·∫π t√¥i - ch·ªó tr·ªëng c·∫ßn m·ªánh ƒë·ªÅ ch·∫ª.",
            "answer": "It is my mother who wants you to contact him from time to time while you‚Äôre out.",
            "explanation": "C·∫•u tr√∫c \"It is ... who\" ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫•n m·∫°nh ch·ªß ng·ªØ \"my mother\".\nD·ªãch nghƒ©a: \"Ch√≠nh m·∫π t√¥i l√† ng∆∞·ªùi mu·ªën b·∫°n li√™n l·∫°c v·ªõi √¥ng ·∫•y t·ª´ th·ªùi gian n√†y sang th·ªùi gian kh√°c khi b·∫°n ra ngo√†i.\""
        },
        {
            "unit": "UNIT 8: BECOMING INDEPENDENT - C√ÇU CH·∫∫",
            "question": "The students make their study plans <u>at school</u>.",
            "hint": "at school (n) ·ªü tr∆∞·ªùng - ch·ªó tr·ªëng c·∫ßn m·ªánh ƒë·ªÅ ch·∫ª.",
            "answer": "It is at school that the students make their study plans.",
            "explanation": "C·∫•u tr√∫c \"It is ... that\" ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫•n m·∫°nh ƒë·ªãa ƒëi·ªÉm \"at school\".\nD·ªãch nghƒ©a: \"Ch√≠nh t·∫°i tr∆∞·ªùng m√† c√°c sinh vi√™n l·∫≠p k·∫ø ho·∫°ch h·ªçc t·∫≠p c·ªßa h·ªç.\""
        },
        {
            "unit": "UNIT 8: BECOMING INDEPENDENT - C√ÇU CH·∫∫",
            "question": "I would like to include <u>all my responsibilities</u> in my weekly schedule.",
            "hint": "all my responsibilities (n) t·∫•t c·∫£ tr√°ch nhi·ªám c·ªßa t√¥i - ch·ªó tr·ªëng c·∫ßn m·ªánh ƒë·ªÅ ch·∫ª.",
            "answer": "It is all my responsibilities that I would like to include in my weekly schedule.",
            "explanation": "C·∫•u tr√∫c \"It is ... that\" ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫•n m·∫°nh \"all my responsibilities\".\nD·ªãch nghƒ©a: \"Ch√≠nh t·∫•t c·∫£ tr√°ch nhi·ªám c·ªßa t√¥i m√† t√¥i mu·ªën ƒë∆∞a v√†o l·ªãch tr√¨nh h√†ng tu·∫ßn c·ªßa m√¨nh.\""
        },
        {
            "unit": "UNIT 8: BECOMING INDEPENDENT - C√ÇU CH·∫∫",
            "question": "We gave a presentation on how to develop life skills <u>the day before yesterday</u>.",
            "hint": "the day before yesterday (n) ng√†y h√¥m kia - ch·ªó tr·ªëng c·∫ßn m·ªánh ƒë·ªÅ ch·∫ª.",
            "answer": "It was the day before yesterday that we gave a presentation on how to develop life skills.",
            "explanation": "C·∫•u tr√∫c \"It was ... that\" ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ nh·∫•n m·∫°nh th·ªùi gian \"the day before yesterday\".\nD·ªãch nghƒ©a: \"Ch√≠nh ng√†y h√¥m kia m√† ch√∫ng t√¥i ƒë√£ c√≥ m·ªôt b√†i thuy·∫øt tr√¨nh v·ªÅ c√°ch ph√°t tri·ªÉn k·ªπ nƒÉng s·ªëng.\""
        }
    ];

    // ========== STATE ==========
    let answers = new Array(quizData.length).fill('');
    let checkedCount = 0;
    const totalQuestions = quizData.length;
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function playSound(type) {
        if (audioCtx.state === 'suspended') audioCtx.resume();
        const osc = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();
        osc.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        if (type === 'correct') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(800, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.1);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.5);
        } else {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(150, audioCtx.currentTime);
            osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
            gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
            osc.start();
            osc.stop(audioCtx.currentTime + 0.3);
        }
    }

    function initQuiz() {
        const quizArea = document.getElementById('quiz-area');
        document.getElementById('total-text').innerText = totalQuestions;

        quizData.forEach((item, index) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `card-${index}`;

            card.innerHTML = `
                <div class="question-header">
                    <span class="q-tag">${item.unit}</span>
                </div>
                <div class="question-text">${index+1}. ${item.question}</div>
                <input type="text" class="answer-input" id="input-${index}" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..." value="${answers[index]}" oninput="updateAnswer(${index}, this.value)">
                <div class="hint-container">
                    <div class="hint-btn" onclick="toggleHint(${index})">
                        <span>üí°</span> G·ª£i √Ω
                    </div>
                    <div class="hint-content" id="hint-${index}">${item.hint}</div>
                </div>
                <div class="check-wrapper">
                    <button class="check-btn" id="check-${index}" onclick="checkAnswer(${index})">üîç Ki·ªÉm tra</button>
                    <span id="feedback-${index}" class="feedback-message"></span>
                </div>
                <div class="explanation-box" id="explain-${index}">
                    <div class="explanation-header">
                        <span style="font-size: 1.5rem;">üìò</span> Gi·∫£i th√≠ch chi ti·∫øt:
                    </div>
                    <div class="explanation-content">${item.explanation.replace(/\n/g, '<br>')}</div>
                </div>
            `;
            quizArea.appendChild(card);
        });
    }

    window.updateAnswer = function(index, value) {
        answers[index] = value;
    };

    window.toggleHint = function(index) {
        const hintDiv = document.getElementById(`hint-${index}`);
        hintDiv.style.display = hintDiv.style.display === 'block' ? 'none' : 'block';
    };

    window.checkAnswer = function(index) {
        const input = document.getElementById(`input-${index}`);
        const checkBtn = document.getElementById(`check-${index}`);
        const explanation = document.getElementById(`explain-${index}`);
        const feedbackSpan = document.getElementById(`feedback-${index}`);
        const userAnswer = answers[index]?.toLowerCase().trim() || '';
        const correctAnswer = quizData[index].answer.toLowerCase().trim();

        // Ki·ªÉm tra n·∫øu ch∆∞a ƒëi·ªÅn
        if (!userAnswer) {
            input.classList.add('error');
            input.focus();
            setTimeout(() => input.classList.remove('error'), 1000);
            return;
        }

        // X√≥a class error n·∫øu c√≥
        input.classList.remove('error');

        // So s√°nh k·∫øt qu·∫£
        if (userAnswer === correctAnswer) {
            input.classList.add('correct');
            input.classList.remove('wrong');
            feedbackSpan.innerHTML = '‚úÖ ƒê√∫ng!';
            feedbackSpan.className = 'feedback-message correct-feedback';
            playSound('correct');
        } else {
            input.classList.add('wrong');
            input.classList.remove('correct');
            feedbackSpan.innerHTML = `‚ùå Sai! ƒê√°p √°n ƒë√∫ng l√†: ${quizData[index].answer}`;
            feedbackSpan.className = 'feedback-message wrong-feedback';
            playSound('wrong');
        }

        // Hi·ªÉn th·ªã gi·∫£i th√≠ch
        explanation.style.display = 'block';

        // V√¥ hi·ªáu h√≥a n√∫t ki·ªÉm tra v√† input
        input.disabled = true;
        checkBtn.disabled = true;

        // C·∫≠p nh·∫≠t s·ªë c√¢u ƒë√£ ki·ªÉm tra
        if (!input.dataset.checked) {
            input.dataset.checked = 'true';
            checkedCount++;
            document.getElementById('progress-text').innerText = checkedCount;
        }
    };

    window.finishQuiz = function() {
        if (checkedCount < totalQuestions) {
            if (!confirm(`B·∫°n m·ªõi ki·ªÉm tra ${checkedCount}/${totalQuestions} c√¢u. B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën xem t·ªïng k·∫øt kh√¥ng?`)) return;
        }

        // ƒê·∫øm s·ªë c√¢u ƒë√∫ng
        let correctCount = 0;
        for (let i = 0; i < totalQuestions; i++) {
            const input = document.getElementById(`input-${i}`);
            if (input && input.classList.contains('correct')) {
                correctCount++;
            }
        }

        const modal = document.getElementById('result-modal');
        document.getElementById('final-score-display').innerText = `${correctCount}/${totalQuestions}`;
        const percentage = (correctCount / totalQuestions) * 100;
        const feedback = document.getElementById('feedback-msg');
        if (percentage === 100) {
            feedback.innerText = "Xu·∫•t s·∫Øc! B·∫°n l√† thi√™n t√†i vi·∫øt l·∫°i c√¢u! üåü";
            triggerConfetti();
        } else if (percentage >= 80) {
            feedback.innerText = "L√†m t·ªët l·∫Øm! Ch·ªâ m·ªôt ch√∫t n·ªØa l√† ho√†n h·∫£o! üî•";
        } else if (percentage >= 50) {
            feedback.innerText = "Kh√° t·ªët, nh∆∞ng h√£y xem l·∫°i ph·∫ßn gi·∫£i th√≠ch k·ªπ h∆°n nh√©! üìö";
        } else {
            feedback.innerText = "ƒê·ª´ng bu·ªìn, h√£y √¥n t·∫≠p l·∫°i v√† th·ª≠ l·∫°i nh√©! üí™";
        }

        modal.style.display = 'flex';
    };

    let currentAnimationId = null;
    function triggerConfetti() {
        if (currentAnimationId) cancelAnimationFrame(currentAnimationId);

        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const particles = [];
        const colors = ['#8854C0', '#00C9A7', '#FF4757', '#FFD700', '#00D26A'];

        for (let i = 0; i < 100; i++) {
            particles.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                vx: Math.random() * 4 - 2,
                vy: Math.random() * 5 + 2,
                color: colors[Math.floor(Math.random() * colors.length)],
                size: Math.random() * 8 + 4
            });
        }

        let startTime = performance.now();

        function animate(now) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            let active = false;
            particles.forEach(p => {
                p.x += p.vx;
                p.y += p.vy;
                if (p.y < canvas.height) active = true;
                ctx.fillStyle = p.color;
                ctx.fillRect(p.x, p.y, p.size, p.size);
            });

            if (active && (now - startTime) < 2000) {
                currentAnimationId = requestAnimationFrame(animate);
            } else {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                currentAnimationId = null;
            }
        }
        currentAnimationId = requestAnimationFrame(animate);
    }

    window.onload = initQuiz;
</script>
</body>
</html>